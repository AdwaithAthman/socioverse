import{ax as dt,ay as ft,az as vt,aA as et,aB as mt,aC as gt,aD as wt,r as w,a2 as Ct,a3 as b,a as yt,aE as xt,j as g,b as L,D as bt}from"./index-1d851ad5.js";class Rt extends dt{constructor(r,t){super(),this.client=r,this.setOptions(t),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var t;const e=this.options;this.options=this.client.defaultMutationOptions(r),ft(e,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(t=this.currentMutation)==null||t.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var r;(r=this.currentMutation)==null||r.removeObserver(this)}}onMutationUpdate(r){this.updateResult();const t={listeners:!0};r.type==="success"?t.onSuccess=!0:r.type==="error"&&(t.onError=!0),this.notify(t)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(r,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof r<"u"?r:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const r=this.currentMutation?this.currentMutation.state:vt(),t={...r,isLoading:r.status==="loading",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=t}notify(r){et.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(r.onSuccess){var t,e,n,i;(t=(e=this.mutateOptions).onSuccess)==null||t.call(e,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(n=(i=this.mutateOptions).onSettled)==null||n.call(i,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(r.onError){var a,s,c,u;(a=(s=this.mutateOptions).onError)==null||a.call(s,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(c=(u=this.mutateOptions).onSettled)==null||c.call(u,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}r.listeners&&this.listeners.forEach(({listener:h})=>{h(this.currentResult)})})}}const St=mt.useSyncExternalStore;function Et(o,r){return typeof o=="function"?o(...r):!!o}function ee(o,r,t){const e=gt(o,r,t),n=wt({context:e.context}),[i]=w.useState(()=>new Rt(n,e));w.useEffect(()=>{i.setOptions(e)},[i,e]);const a=St(w.useCallback(c=>i.subscribe(et.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),s=w.useCallback((c,u)=>{i.mutate(c,u).catch(Mt)},[i]);if(a.error&&Et(i.options.useErrorBoundary,[a.error]))throw a.error;return{...a,mutate:s,mutateAsync:a.mutate}}function Mt(){}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var I=function(o,r){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},I(o,r)};function _t(o,r){I(o,r);function t(){this.constructor=o}o.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var d=function(){return d=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},d.apply(this,arguments)},Y=!1,R,j,Z,A,O,rt,W,F,U,k,ot,B,H,nt,it;function f(){if(!Y){Y=!0;var o=navigator.userAgent,r=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(o),t=/(Mac OS X)|(Windows)|(Linux)/.exec(o);if(B=/\b(iPhone|iP[ao]d)/.exec(o),H=/\b(iP[ao]d)/.exec(o),k=/Android/i.exec(o),nt=/FBAN\/\w+;/i.exec(o),it=/Mobile/i.exec(o),ot=!!/Win64/.exec(o),r){R=r[1]?parseFloat(r[1]):r[5]?parseFloat(r[5]):NaN,R&&document&&document.documentMode&&(R=document.documentMode);var e=/(?:Trident\/(\d+.\d+))/.exec(o);rt=e?parseFloat(e[1])+4:R,j=r[2]?parseFloat(r[2]):NaN,Z=r[3]?parseFloat(r[3]):NaN,A=r[4]?parseFloat(r[4]):NaN,A?(r=/(?:Chrome\/(\d+\.\d+))/.exec(o),O=r&&r[1]?parseFloat(r[1]):NaN):O=NaN}else R=j=Z=O=A=NaN;if(t){if(t[1]){var n=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(o);W=n?parseFloat(n[1].replace("_",".")):!0}else W=!1;F=!!t[2],U=!!t[3]}else W=F=U=!1}}var G={ie:function(){return f()||R},ieCompatibilityMode:function(){return f()||rt>R},ie64:function(){return G.ie()&&ot},firefox:function(){return f()||j},opera:function(){return f()||Z},webkit:function(){return f()||A},safari:function(){return G.webkit()},chrome:function(){return f()||O},windows:function(){return f()||F},osx:function(){return f()||W},linux:function(){return f()||U},iphone:function(){return f()||B},mobile:function(){return f()||B||H||k||it},nativeApp:function(){return f()||nt},android:function(){return f()||k},ipad:function(){return f()||H}},Dt=G,D=!!(typeof window<"u"&&window.document&&window.document.createElement),Pt={canUseDOM:D,canUseWorkers:typeof Worker<"u",canUseEventListeners:D&&!!(window.addEventListener||window.attachEvent),canUseViewport:D&&!!window.screen,isInWorker:!D},zt=Pt,at=zt,st;at.canUseDOM&&(st=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function At(o,r){if(!at.canUseDOM||r&&!("addEventListener"in document))return!1;var t="on"+o,e=t in document;if(!e){var n=document.createElement("div");n.setAttribute(t,"return;"),e=typeof n[t]=="function"}return!e&&st&&o==="wheel"&&(e=document.implementation.hasFeature("Events.wheel","3.0")),e}var Ot=At,Wt=Dt,Nt=Ot,V=10,q=40,J=800;function ct(o){var r=0,t=0,e=0,n=0;return"detail"in o&&(t=o.detail),"wheelDelta"in o&&(t=-o.wheelDelta/120),"wheelDeltaY"in o&&(t=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(r=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(r=t,t=0),e=r*V,n=t*V,"deltaY"in o&&(n=o.deltaY),"deltaX"in o&&(e=o.deltaX),(e||n)&&o.deltaMode&&(o.deltaMode==1?(e*=q,n*=q):(e*=J,n*=J)),e&&!r&&(r=e<1?-1:1),n&&!t&&(t=n<1?-1:1),{spinX:r,spinY:t,pixelX:e,pixelY:n}}ct.getEventType=function(){return Wt.firefox()?"DOMMouseScroll":Nt("wheel")?"wheel":"mousewheel"};var Tt=ct,Lt=Tt;const It=Ct(Lt);function jt(o,r,t,e,n,i){i===void 0&&(i=0);var a=E(o,r,i),s=a.width,c=a.height,u=Math.min(s,t),h=Math.min(c,e);return u>h*n?{width:h*n,height:h}:{width:u,height:u/n}}function Zt(o){return o.width>o.height?o.width/o.naturalWidth:o.height/o.naturalHeight}function P(o,r,t,e,n){n===void 0&&(n=0);var i=E(r.width,r.height,n),a=i.width,s=i.height;return{x:K(o.x,a,t.width,e),y:K(o.y,s,t.height,e)}}function K(o,r,t,e){var n=r*e/2-t/2;return N(o,-n,n)}function Q(o,r){return Math.sqrt(Math.pow(o.y-r.y,2)+Math.pow(o.x-r.x,2))}function $(o,r){return Math.atan2(r.y-o.y,r.x-o.x)*180/Math.PI}function Ft(o,r,t,e,n,i,a){i===void 0&&(i=0),a===void 0&&(a=!0);var s=a?Ut:kt,c=E(r.width,r.height,i),u=E(r.naturalWidth,r.naturalHeight,i),h={x:s(100,((c.width-t.width/n)/2-o.x/n)/c.width*100),y:s(100,((c.height-t.height/n)/2-o.y/n)/c.height*100),width:s(100,t.width/c.width*100/n),height:s(100,t.height/c.height*100/n)},l=Math.round(s(u.width,h.width*u.width/100)),p=Math.round(s(u.height,h.height*u.height/100)),C=u.width>=u.height*e,v=C?{width:Math.round(p*e),height:p}:{width:l,height:Math.round(l/e)},m=d(d({},v),{x:Math.round(s(u.width-v.width,h.x*u.width/100)),y:Math.round(s(u.height-v.height,h.y*u.height/100))});return{croppedAreaPercentages:h,croppedAreaPixels:m}}function Ut(o,r){return Math.min(o,Math.max(0,r))}function kt(o,r){return r}function Bt(o,r,t,e,n,i){var a=E(r.width,r.height,t),s=N(e.width/a.width*(100/o.width),n,i),c={x:s*a.width/2-e.width/2-a.width*s*(o.x/100),y:s*a.height/2-e.height/2-a.height*s*(o.y/100)};return{crop:c,zoom:s}}function Ht(o,r,t){var e=Zt(r);return t.height>t.width?t.height/(o.height*e):t.width/(o.width*e)}function Gt(o,r,t,e,n,i){t===void 0&&(t=0);var a=E(r.naturalWidth,r.naturalHeight,t),s=N(Ht(o,r,e),n,i),c=e.height>e.width?e.height/o.height:e.width/o.width,u={x:((a.width-o.width)/2-o.x)*c,y:((a.height-o.height)/2-o.y)*c};return{crop:u,zoom:s}}function tt(o,r){return{x:(r.x+o.x)/2,y:(r.y+o.y)/2}}function Xt(o){return o*Math.PI/180}function E(o,r,t){var e=Xt(t);return{width:Math.abs(Math.cos(e)*o)+Math.abs(Math.sin(e)*r),height:Math.abs(Math.sin(e)*o)+Math.abs(Math.cos(e)*r)}}function N(o,r,t){return Math.min(Math.max(o,r),t)}function z(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return o.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var Yt=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,Vt=1,qt=3,Jt=function(o){_t(r,o);function r(){var t=o!==null&&o.apply(this,arguments)||this;return t.imageRef=b.createRef(),t.videoRef=b.createRef(),t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.state={cropSize:null,hasWheelJustStarted:!1},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var e=!0;t.resizeObserver=new window.ResizeObserver(function(n){if(e){e=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(e){return e.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturemove",t.onGestureMove),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var e=t.computeSizes();e&&(t.emitCropData(),t.setInitialCrop(e)),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(e){if(t.props.initialCroppedAreaPercentages){var n=Bt(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,e,t.props.minZoom,t.props.maxZoom),i=n.crop,a=n.zoom;t.props.onCropChange(i),t.props.onZoomChange&&t.props.onZoomChange(a)}else if(t.props.initialCroppedAreaPixels){var s=Gt(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,e,t.props.minZoom,t.props.maxZoom),i=s.crop,a=s.zoom;t.props.onCropChange(i),t.props.onZoomChange&&t.props.onZoomChange(a)}},t.computeSizes=function(){var e,n,i,a,s,c,u=t.imageRef.current||t.videoRef.current;if(u&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect();var h=t.containerRect.width/t.containerRect.height,l=((e=t.imageRef.current)===null||e===void 0?void 0:e.naturalWidth)||((n=t.videoRef.current)===null||n===void 0?void 0:n.videoWidth)||0,p=((i=t.imageRef.current)===null||i===void 0?void 0:i.naturalHeight)||((a=t.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,C=u.offsetWidth<l||u.offsetHeight<p,v=l/p,m=void 0;if(C){var M=t.getObjectFit();switch(M){default:case"contain":m=h>v?{width:t.containerRect.height*v,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/v};break;case"horizontal-cover":m={width:t.containerRect.width,height:t.containerRect.width/v};break;case"vertical-cover":m={width:t.containerRect.height*v,height:t.containerRect.height};break}}else m={width:u.offsetWidth,height:u.offsetHeight};t.mediaSize=d(d({},m),{naturalWidth:l,naturalHeight:p}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var y=t.props.cropSize?t.props.cropSize:jt(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((s=t.state.cropSize)===null||s===void 0?void 0:s.height)!==y.height||((c=t.state.cropSize)===null||c===void 0?void 0:c.width)!==y.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(y),t.setState({cropSize:y},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(y),y}},t.onMouseDown=function(e){t.currentDoc&&(e.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.onDragStart(r.getMousePoint(e)))},t.onMouseMove=function(e){return t.onDrag(r.getMousePoint(e))},t.onTouchStart=function(e){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(e))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),e.touches.length===2?t.onPinchStart(e):e.touches.length===1&&t.onDragStart(r.getTouchPoint(e.touches[0]))))},t.onTouchMove=function(e){e.preventDefault(),e.touches.length===2?t.onPinchMove(e):e.touches.length===1&&t.onDrag(r.getTouchPoint(e.touches[0]))},t.onGestureStart=function(e){t.currentDoc&&(e.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureMove),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureMove=function(e){if(e.preventDefault(),!t.isTouching){var n=r.getMousePoint(e),i=t.gestureZoomStart-1+e.scale;if(t.setNewZoom(i,n,{shouldUpdatePosition:!0}),t.props.onRotationChange){var a=t.gestureRotationStart+e.rotation;t.props.onRotationChange(a)}}},t.onGestureEnd=function(e){t.cleanEvents()},t.onDragStart=function(e){var n,i,a=e.x,s=e.y;t.dragStartPosition={x:a,y:s},t.dragStartCrop=d({},t.props.crop),(i=(n=t.props).onInteractionStart)===null||i===void 0||i.call(n)},t.onDrag=function(e){var n=e.x,i=e.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(n===void 0||i===void 0)){var a=n-t.dragStartPosition.x,s=i-t.dragStartPosition.y,c={x:t.dragStartCrop.x+a,y:t.dragStartCrop.y+s},u=t.props.restrictPosition?P(c,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):c;t.props.onCropChange(u)}}))},t.onDragStopped=function(){var e,n;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(n=(e=t.props).onInteractionEnd)===null||n===void 0||n.call(e)},t.onWheel=function(e){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(e))){e.preventDefault();var n=r.getMousePoint(e),i=It(e).pixelY,a=t.props.zoom-i*t.props.zoomSpeed/200;t.setNewZoom(a,n,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var s,c;return(c=(s=t.props).onInteractionStart)===null||c===void 0?void 0:c.call(s)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var s,c;return(c=(s=t.props).onInteractionEnd)===null||c===void 0?void 0:c.call(s)})},250)}},t.getPointOnContainer=function(e){var n=e.x,i=e.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(n-t.containerRect.left),y:t.containerRect.height/2-(i-t.containerRect.top)}},t.getPointOnMedia=function(e){var n=e.x,i=e.y,a=t.props,s=a.crop,c=a.zoom;return{x:(n+s.x)/c,y:(i+s.y)/c}},t.setNewZoom=function(e,n,i){var a=i===void 0?{}:i,s=a.shouldUpdatePosition,c=s===void 0?!0:s;if(!(!t.state.cropSize||!t.props.onZoomChange)){var u=N(e,t.props.minZoom,t.props.maxZoom);if(c){var h=t.getPointOnContainer(n),l=t.getPointOnMedia(h),p={x:l.x*u-h.x,y:l.y*u-h.y},C=t.props.restrictPosition?P(p,t.mediaSize,t.state.cropSize,u,t.props.rotation):p;t.props.onCropChange(C)}t.props.onZoomChange(u)}},t.getCropData=function(){if(!t.state.cropSize)return null;var e=t.props.restrictPosition?P(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return Ft(e,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var e=t.getCropData();if(e){var n=e.croppedAreaPercentages,i=e.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(n,i),t.props.onCropAreaChange&&t.props.onCropAreaChange(n,i)}},t.emitCropAreaChange=function(){var e=t.getCropData();if(e){var n=e.croppedAreaPercentages,i=e.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(n,i)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var e=t.props.restrictPosition?P(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;t.props.onCropChange(e),t.emitCropData()}},t}return r.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=Yt,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef))},r.prototype.componentWillUnmount=function(){var t,e;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((e=this.styleRef.parentNode)===null||e===void 0||e.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},r.prototype.componentDidUpdate=function(t){var e,n,i,a,s,c,u,h,l;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((e=t.cropSize)===null||e===void 0?void 0:e.height)!==((n=this.props.cropSize)===null||n===void 0?void 0:n.height)||((i=t.cropSize)===null||i===void 0?void 0:i.width)!==((a=this.props.cropSize)===null||a===void 0?void 0:a.width)?this.computeSizes():(((s=t.crop)===null||s===void 0?void 0:s.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((u=t.crop)===null||u===void 0?void 0:u.y)!==((h=this.props.crop)===null||h===void 0?void 0:h.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((l=this.videoRef.current)===null||l===void 0||l.load())},r.prototype.getAspect=function(){var t=this.props,e=t.cropSize,n=t.aspect;return e?e.width/e.height:n},r.prototype.getObjectFit=function(){var t,e,n,i;if(this.props.objectFit==="cover"){var a=this.imageRef.current||this.videoRef.current;if(a&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var s=this.containerRect.width/this.containerRect.height,c=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((e=this.videoRef.current)===null||e===void 0?void 0:e.videoWidth)||0,u=((n=this.imageRef.current)===null||n===void 0?void 0:n.naturalHeight)||((i=this.videoRef.current)===null||i===void 0?void 0:i.videoHeight)||0,h=c/u;return h<s?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},r.prototype.onPinchStart=function(t){var e=r.getTouchPoint(t.touches[0]),n=r.getTouchPoint(t.touches[1]);this.lastPinchDistance=Q(e,n),this.lastPinchRotation=$(e,n),this.onDragStart(tt(e,n))},r.prototype.onPinchMove=function(t){var e=this;if(!(!this.currentDoc||!this.currentWindow)){var n=r.getTouchPoint(t.touches[0]),i=r.getTouchPoint(t.touches[1]),a=tt(n,i);this.onDrag(a),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var s=Q(n,i),c=e.props.zoom*(s/e.lastPinchDistance);e.setNewZoom(c,a,{shouldUpdatePosition:!1}),e.lastPinchDistance=s;var u=$(n,i),h=e.props.rotation+(u-e.lastPinchRotation);e.props.onRotationChange&&e.props.onRotationChange(h),e.lastPinchRotation=u})}},r.prototype.render=function(){var t=this,e=this.props,n=e.image,i=e.video,a=e.mediaProps,s=e.transform,c=e.crop,u=c.x,h=c.y,l=e.rotation,p=e.zoom,C=e.cropShape,v=e.showGrid,m=e.style,M=m.containerStyle,y=m.cropAreaStyle,x=m.mediaStyle,_=e.classes,ht=_.containerClassName,lt=_.cropAreaClassName,X=_.mediaClassName,S=this.getObjectFit();return b.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(pt){return t.containerRef=pt},"data-testid":"container",style:M,className:z("reactEasyCrop_Container",ht)},n?b.createElement("img",d({alt:"",className:z("reactEasyCrop_Image",S==="contain"&&"reactEasyCrop_Contain",S==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",S==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",X)},a,{src:n,ref:this.imageRef,style:d(d({},x),{transform:s||"translate(".concat(u,"px, ").concat(h,"px) rotate(").concat(l,"deg) scale(").concat(p,")")}),onLoad:this.onMediaLoad})):i&&b.createElement("video",d({autoPlay:!0,loop:!0,muted:!0,className:z("reactEasyCrop_Video",S==="contain"&&"reactEasyCrop_Contain",S==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",S==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",X)},a,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:d(d({},x),{transform:s||"translate(".concat(u,"px, ").concat(h,"px) rotate(").concat(l,"deg) scale(").concat(p,")")}),controls:!1}),(Array.isArray(i)?i:[{src:i}]).map(function(T){return b.createElement("source",d({key:T.src},T))})),this.state.cropSize&&b.createElement("div",{style:d(d({},y),{width:this.state.cropSize.width,height:this.state.cropSize.height}),"data-testid":"cropper",className:z("reactEasyCrop_CropArea",C==="round"&&"reactEasyCrop_CropAreaRound",v&&"reactEasyCrop_CropAreaGrid",lt)}))},r.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:qt,minZoom:Vt,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0},r.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r}(b.Component);const Kt=o=>new Promise((r,t)=>{const e=new Image;e.addEventListener("load",()=>r(e)),e.addEventListener("error",n=>t(n)),e.setAttribute("crossOrigin","anonymous"),e.src=o});function ut(o){return o*Math.PI/180}function Qt(o,r,t){const e=ut(t);return{width:Math.abs(Math.cos(e)*o)+Math.abs(Math.sin(e)*r),height:Math.abs(Math.sin(e)*o)+Math.abs(Math.cos(e)*r)}}async function $t(o,r,t=0,e={horizontal:!1,vertical:!1}){const n=await Kt(o),i=document.createElement("canvas"),a=i.getContext("2d");if(!a)return null;const s=ut(t),{width:c,height:u}=Qt(n.width,n.height,t);i.width=c,i.height=u,a.translate(c/2,u/2),a.rotate(s),a.scale(e.horizontal?-1:1,e.vertical?-1:1),a.translate(-n.width/2,-n.height/2),a.drawImage(n,0,0);const h=a.getImageData(r.x,r.y,r.width,r.height);return i.width=r.width,i.height=r.height,a.putImageData(h,0,0),new Promise(l=>{i.toBlob(p=>{l(p)},"image/jpeg")})}const re=({image:o,getImage:r,aspectRatio:t})=>{const[e,n]=w.useState({x:0,y:0}),[i,a]=w.useState(1),[s,c]=w.useState(0),[u,h]=w.useState(null),[l,p]=w.useState(null),C=yt(),v=w.useCallback((x,_)=>{h(_)},[]),m=w.useCallback(async()=>{try{if(u){const x=await $t(o,u,s);x&&p(x)}}catch(x){console.error(x)}},[u,s,o]),M=w.useCallback(()=>{p(null)},[]),y=w.useCallback(()=>{t===1.5/1&&l&&C(xt(URL.createObjectURL(l))),r(l)},[t,l,C,r]);return g.jsx(g.Fragment,{children:g.jsxs("div",{className:"flex flex-col",children:[g.jsx("div",{className:"z-10 container",style:{display:o===null||l!==null?"none":"block"},children:g.jsx("div",{className:"crop-container z-20",children:g.jsx(Jt,{image:o,crop:e,rotation:s,zoom:i,zoomSpeed:4,maxZoom:3,zoomWithScroll:!0,showGrid:!0,aspect:t,onCropChange:n,onCropComplete:v,onZoomChange:a,onRotationChange:c,cropShape:t===4/4?"round":"rect"})})}),g.jsx(L.Button,{style:{display:o===null||l!==null?"none":"block"},onClick:m,className:"z-30 bg-socioverse-500 text-white",children:"Crop"}),g.jsxs("div",{className:"cropped-image-container",children:[l&&g.jsx("div",{className:"flex item-center justify-center border-4 border-double border-blue-gray-400",children:g.jsx("img",{className:bt("cropped-image p-2 ",{" w-full, h-full":t===4/1},{"w-[26rem] h-56 md:h-80":t===1.5/1},{"w-80 h-80 rounded-full":t===4/4}),src:URL.createObjectURL(l),alt:"cropped"})}),l&&g.jsxs("div",{className:"flex items-center justify-start mt-6 gap-4 ",children:[g.jsx(L.Button,{variant:"outlined",size:"sm",className:"rounded-full text-black border-black",onClick:M,children:"Cancel"}),g.jsx(L.Button,{size:"sm",className:"rounded-full bg-socioverse-500",onClick:y,children:"Update"})]})]})]})})};export{re as I,ee as u};
