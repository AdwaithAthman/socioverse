import{a as N,m as T,u as S,r as c,n as E,o as O,g as B,j as e,k as D,b as u,C as w,L as M,B as V,q as $,R,t as v,v as G,h as q,Q as m,T as j,i as H,f as L,e as Q,c as z,s as I,d as J,S as K}from"./index-6d813b4e.js";import{f as y}from"./index-fe2a000f.js";import{T as W}from"./index.esm-6fbf03ea.js";const X=({socket:g})=>{const l=N(),d=T(),o=S(s=>s.auth.user),[h,r]=c.useState([]),[i,_]=c.useState([]),[b,C]=c.useState([]),[n,x]=c.useState();c.useEffect(()=>{o&&(E(o._id).then(s=>{_(s.following)}),O(o._id).then(s=>{r(s.followers)}),B().then(s=>{C(s.suggestions)}))},[o,l]),c.useEffect(()=>{o&&x(o.following)},[o]);const f=[{label:"Followers",value:"followers",desc:h.length>0?h:"No followers yet..."},{label:"Following",value:"following",desc:i.length>0?i:"No following yet..."},{label:"Suggested",value:"suggested",desc:b.length>0?b:"No suggestions available..."}],A=async s=>{const a=await y(s);l(v(a.chat)),location.pathname!=="/message"&&d("/message")},k=async s=>{const a=await y(s);l(v(a.chat)),g&&g.emit("call-user",o,a.chat),l(G(!0)),location.pathname!=="/message"&&d("/message")},U=(s,a)=>{q(s).then(()=>{m.dismiss(),m.success(`Unfollowed ${a}`,j)}),x(n==null?void 0:n.filter(t=>t!==s)),l(H(s))},F=(s,a)=>{L(s).then(()=>{m.dismiss(),m.success(`Following ${a}`,j)}),!(n!=null&&n.includes(s))&&x([...n,s]),l(Q(s))};return e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsxs(u.Tabs,{id:"custom-animation",value:"followers",children:[e.jsx(u.TabsHeader,{className:"sticky",children:f.map(({label:s,value:a})=>e.jsx(u.Tab,{value:a,children:s},a))}),e.jsx(u.TabsBody,{animate:{initial:{y:250},mount:{y:0},unmount:{y:250}},className:"overflow-y-auto h-[75vh] md:no-scrollbar",children:f.map(({value:s,desc:a})=>e.jsx(u.TabPanel,{value:s,children:typeof a=="string"?e.jsxs("div",{className:"flex flex-col items-center justify-center mt-4",children:[e.jsx("div",{className:"w-80 mx-auto",children:e.jsx("img",{src:w.NO_DATA_AVAILABLE_SVG,alt:"no data available"})}),e.jsx("h1",{children:a})]}):e.jsx("div",{className:"flex flex-col gap-4 max-w-[24rem] mx-auto mt-4",children:a.map(t=>{var p;return e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-2 items-center justify-between transition duration-100 ease-in-out shadow-md ",children:[e.jsx(M,{to:`/profile/${t._id}`,children:e.jsxs("div",{className:"mt-3 flex items-center space-x-2",children:[e.jsx("img",{className:"inline-block h-10 w-10 rounded-full",src:t.dp?t.dp:w.DEFAULT_IMG,alt:"user dp"}),e.jsxs("span",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[14px] font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("span",{className:"text-[11px] font-medium text-gray-500",children:t.username?`@${t.username}`:"@ -"})]})]})}),s!=="suggested"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-100 rounded-full cursor-pointer border-2 border-blue-gray-500 hover:border-green-500 hover:bg-white hover:border-3 group",onClick:()=>A(t._id),children:e.jsx(V,{className:"text-md text-socioverse-500 group-hover:text-green-500"})}),e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-100 rounded-full cursor-pointer border-2 border-blue-gray-500 hover:border-green-500 hover:bg-white hover:border-3 group",onClick:()=>k(t._id),children:e.jsx($,{className:"text-xl text-socioverse-500  group-hover:text-green-500"})})]}):n!=null&&n.includes(t._id)||o&&((p=t.followers)!=null&&p.includes(o._id))?e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-500 rounded-full cursor-pointer border-2 border-blue-gray-700 hover:border-red-700 hover:bg-white hover:border-3 group",onClick:()=>U(t._id,t.name),children:e.jsx(R,{className:"text-xl text-white group-hover:text-red-500"})}):e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-100 rounded-full cursor-pointer border-2 border-blue-gray-500 hover:bg-white hover:border-3 group",onClick:()=>F(t._id,t.name),children:e.jsx(W,{className:"text-xl text-socioverse-500 group-hover:text-blue-gray-500"})})]},t._id)})})},s))})]})]})},ee=({socket:g})=>{const l=N(),d=T(),o=S(r=>r.auth.user);c.useEffect(()=>{o||h()||d("/error")},[o]);const h=async()=>{try{const{user:r}=await z(),{accessToken:i}=I.getState().auth;return l(J({user:r,accessToken:i})),r}catch(r){if(K(r)){const i=r;i.response&&i.response.status>=400&&i.response.status<=500&&d("/login")}}};return e.jsx("div",{className:"lg:hidden block",children:e.jsx(X,{socket:g})})};export{ee as default};
