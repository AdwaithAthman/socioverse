import{a as T,n as _,u as C,r as c,o as O,p as E,g as B,b as D,j as e,k as M,c as u,C as v,L as V,B as R,t as $,R as G,v as j,w as H,i as L,Q as x,T as y,l as Q,f as q,h as z,d as I,s as J,e as K,U as W}from"./index-f946f455.js";import{f as N}from"./index-fece1ea8.js";import{T as X}from"./index.esm-57e7230c.js";const Y=({socket:g})=>{const l=T(),d=_(),o=C(s=>s.auth.user),[h,r]=c.useState([]),[i,S]=c.useState([]),[f,b]=c.useState([]),[n,m]=c.useState();c.useEffect(()=>{o&&(O(o._id).then(s=>{S(s.following)}),E(o._id).then(s=>{r(s.followers)}),B().then(s=>{s.suggestions.length===0?D().then(a=>b(a.users)):b(s.suggestions)}))},[o,l]),c.useEffect(()=>{o&&m(o.following)},[o]);const p=[{label:"Followers",value:"followers",desc:h.length>0?h:"No followers yet..."},{label:"Following",value:"following",desc:i.length>0?i:"No following yet..."},{label:"Suggested",value:"suggested",desc:f.length>0?f:"No suggestions available..."}],A=async s=>{const a=await N(s);l(j(a.chat)),location.pathname!=="/message"&&d("/message")},U=async s=>{const a=await N(s);l(j(a.chat)),g&&g.emit("call-user",o,a.chat),l(H(!0)),location.pathname!=="/message"&&d("/message")},k=(s,a)=>{L(s).then(()=>{x.dismiss(),x.success(`Unfollowed ${a}`,y)}),m(n==null?void 0:n.filter(t=>t!==s)),l(Q(s))},F=(s,a)=>{q(s).then(()=>{x.dismiss(),x.success(`Following ${a}`,y)}),!(n!=null&&n.includes(s))&&m([...n,s]),l(z(s))};return e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsxs(u.Tabs,{id:"custom-animation",value:"followers",children:[e.jsx(u.TabsHeader,{className:"sticky",children:p.map(({label:s,value:a})=>e.jsx(u.Tab,{value:a,children:s},a))}),e.jsx(u.TabsBody,{animate:{initial:{y:250},mount:{y:0},unmount:{y:250}},className:"overflow-y-auto h-[75vh] md:no-scrollbar",children:p.map(({value:s,desc:a})=>e.jsx(u.TabPanel,{value:s,children:typeof a=="string"?e.jsxs("div",{className:"flex flex-col items-center justify-center mt-4",children:[e.jsx("div",{className:"w-80 mx-auto",children:e.jsx("img",{src:v.NO_DATA_AVAILABLE_SVG,alt:"no data available"})}),e.jsx("h1",{children:a})]}):e.jsx("div",{className:"flex flex-col gap-4 max-w-[24rem] mx-auto mt-4",children:a.map(t=>{var w;return e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-2 items-center justify-between transition duration-100 ease-in-out shadow-md ",children:[e.jsx(V,{to:`/profile/${t._id}`,children:e.jsxs("div",{className:"mt-3 flex items-center space-x-2",children:[e.jsx("img",{className:"inline-block h-10 w-10 rounded-full",src:t.dp?t.dp:v.DEFAULT_IMG,alt:"user dp"}),e.jsxs("span",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[14px] font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("span",{className:"text-[11px] font-medium text-gray-500",children:t.username?`@${t.username}`:"@ -"})]})]})}),s!=="suggested"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-100 rounded-full cursor-pointer border-2 border-blue-gray-500 hover:border-green-500 hover:bg-white hover:border-3 group",onClick:()=>A(t._id),children:e.jsx(R,{className:"text-md text-socioverse-500 group-hover:text-green-500"})}),e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-100 rounded-full cursor-pointer border-2 border-blue-gray-500 hover:border-green-500 hover:bg-white hover:border-3 group",onClick:()=>U(t._id),children:e.jsx($,{className:"text-xl text-socioverse-500  group-hover:text-green-500"})})]}):n!=null&&n.includes(t._id)||o&&((w=t.followers)!=null&&w.includes(o._id))?e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-500 rounded-full cursor-pointer border-2 border-blue-gray-700 hover:border-red-700 hover:bg-white hover:border-3 group",onClick:()=>k(t._id,t.name),children:e.jsx(G,{className:"text-xl text-white group-hover:text-red-500"})}):e.jsx("div",{className:"flex justify-center items-center w-8 h-8 transition duration-300 ease-in-out bg-blue-gray-100 rounded-full cursor-pointer border-2 border-blue-gray-500 hover:bg-white hover:border-3 group",onClick:()=>F(t._id,t.name),children:e.jsx(X,{className:"text-xl text-socioverse-500 group-hover:text-blue-gray-500"})})]},t._id)})})},s))})]})]})},se=({socket:g})=>{const l=T(),d=_(),o=C(r=>r.auth.user);c.useEffect(()=>{o||h()||d("/error")},[o]);const h=async()=>{try{const{user:r}=await I(),{accessToken:i}=J.getState().auth;return l(K({user:r,accessToken:i})),r}catch(r){if(W(r)){const i=r;i.response&&i.response.status>=400&&i.response.status<=500&&d("/login")}}};return e.jsx("div",{className:"lg:hidden block",children:e.jsx(Y,{socket:g})})};export{se as default};
